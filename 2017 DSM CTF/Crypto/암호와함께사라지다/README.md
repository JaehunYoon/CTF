# 암호와함께사라지다

## Problem

대회를 앞두고 성훈이가 사라졌다. 책상에는 RSA 공개키 알고리즘 내용이 나온 실용암호학 책이 펼쳐져 있다. 책상엔 희미하게 연필로 적은 이상한 수가 나열되어 있다. 읽을수는 없어보이는데.. 여기에 무슨 뜻이 있는걸까? 


(성훈이의 공개키 : (107, 493)) 


408, 108, 111, 254, 81, 408, 143, 75, 349, 122, 238, 223, 217, 147, 58, 367, 143, 223, 235, 94, 463, 235, 331, 147, 11, 468, 102, 219, 11, 210, 237, 80 

HINT : 책상에 적힌 숫자는 성훈이가 개인키로 암호화 시키고 얻은 암호문입니다.

***

## Solution

RSA 알고리즘으로 암호화 문제이다.

```
m : 평문<br/>
c : 암호문<br/>
{e, n} : 공개키<br/>
e = y(N)과 서로소인 값
{d} : 개인키<br/>
N = pq<br/>
φ(N) = (p-1)(q-1)
```

라고 할 때, RSA 암호화, 복호화 공식은 다음과 같다.

**RSA 암호화공식 : Ｅke(m) = m^e Mod n = c**

**RSA 복호화공식 : Ｄke(c) = ((m^e)^d) Mod n = c^d Mod n = m**

복호화 할 때에는 `c^d % n = m` 의 공식을 사용해야 하는데, 처음에 공개키로 암호를 하는 것이 RSA의 본래 원리이지만 문제에서는 개인키로 암호화를 했다고 주어졌기 때문에, 반대로 복호화를 할 때에는 공개키의 e 부분을 공식의 d 부분에 넣어주어 연산을 하면 RSA 복호화를 진행할 수 있다.

다음은 복호화를 위해 사용한 파이썬 코드이다.

```python
# m : 평문
# c : 암호문
# <e, n> : 공개키
# <d> : 개인키
# N = pq
# y(N) = (p-1)(q-1)
# e = y(N)과 서로소인 값


d = int(input("Input e > "))  # 공개 키에서 e 부분을 입력 (107)
n = int(input("Input n > "))  # 공개 키에서 n 부분을 입력 (493)
value_list = input("Input all value list :").split(",")
# 암호문 입력(408, 108, 111, 254, 81, 408, 143, 75, 349, 122, 238, 223, 217, 147, 58, 367, 143, 223, 235, 94, 463, 235,
# 331, 147, 11, 468, 102, 219, 11, 210, 237, 80)
value_list = [int(c) for c in value_list]

result = ""
for c in value_list:
    result += chr(c ** d % n)

print(result)
```

공개 키는 <107, 493> 이기 때문에, d 변수에는 107을 n 변수에 493을 대입한다. value_list에 암호문 리스트를 입력해주면 암호문들이 복호화되어 Flag가 나오게 된다.

![Image](https://github.com/JaehunYoon/CTF/blob/master/2017%20DSM%20CTF/Crypto/%EC%95%94%ED%98%B8%ED%99%94%ED%95%A8%EA%BB%98%EC%82%AC%EB%9D%BC%EC%A7%80%EB%8B%A4/Image/flag.PNG)

Flag : **DISC{D0cum3n7ati0n_1s_hardwork!}**